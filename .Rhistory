by=c("ophio_gene")) %>%
## add rhythmicity data - ophio_cflo - infected
left_join(rhy.24.sig[[3]] %>%
select(ophio_gene=ID, inf_pval=GammaP) %>%
mutate(inf_rhy24 = ifelse(inf_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## arrange the columns
select(ophio_gene, gene_desc, inf_v_control, abs_log2FC,
enriched_annot,
control_rhy24, inf_rhy24, GOs:TMHMM, everything()) %>%
## arrange by enriched_annot
arrange(inf_v_control, desc(abs_log2FC), enriched_annot)
}
gsoi.6[[1]]
gsoi.6[[2]]
i=1
gsoi.6[[i]] <-
which.degs[[i]] %>%
check_enrichment(.,
org = "ophio_cflo",
bg = bg.genes,
what = "pfams",
expand = T) %>%
# nothing much to talk about things that have no annotations ---
filter(annot_desc!="no_desc") %>%
# save the results to a file
arrange(annot_desc)
gsoi.6[[i]]
is.null(nrow(gsoi.6[[i]]))==F
length(which.degs
)
gsoi.6[[i]]
i
gsoi.6[[i]] %>% nrow()
gsoi.6[[i]] %>% is.null()
is.null(gsoi.6[[i]])==F
is.null(gsoi.6[[i]])!=F
is.null(gsoi.6[[i]])==F
gsoi.6[[i]][,c(1,3)]
# define the background for enrichment analyses
bg.genes <- rownames(emat)
### Gene set of interest 6 ###
gsoi.6 <- list()
## loop begins
for (i in length(which.degs)) {
gsoi.6[[i]] <-
which.degs[[i]] %>%
check_enrichment(.,
org = "ophio_cflo",
bg = bg.genes,
what = "pfams",
expand = T) %>%
# nothing much to talk about things that have no annotations ---
filter(annot_desc!="no_desc") %>%
# save the results to a file
arrange(annot_desc)
if(is.null(gsoi.6[[i]])==F) {
# MAKE THE SUPP FILE
gsoi.6[[i]] <-
annots[[2]] %>%
select(gene_name, gene_desc, GOs, pfams, signalP, SSP, TMHMM) %>%
filter(gene_name %in% which.degs[[i]]) %>%  # change here
left_join(gsoi.6[[i]][,c(1,3)], by="gene_name") %>%  # change here
select(gene_name, gene_desc, enriched_annot=annot_desc, everything()) %>%
# mutate(enriched_annot=as.factor(enriched_annot)) %>%
arrange(enriched_annot)
} else {
# MAKE THE SUPP FILE
gsoi.6[[i]] <-
annots[[2]] %>%
select(gene_name, gene_desc, GOs, pfams, signalP, SSP, TMHMM) %>%
filter(gene_name %in% which.degs[[i]]) %>%  # change here
# left_join(gsoi.6[[i]][,c(1,3)], by="gene_name")) # change here
mutate(annot_desc=NA) %>%
select(gene_name, gene_desc, enriched_annot=annot_desc, everything()) %>%
# mutate(enriched_annot=as.factor(enriched_annot)) %>%
arrange(enriched_annot)
}
# MAKE THE SUPP FILE - contd.
gsoi.6[[i]] <-
gsoi.6[[i]] %>%
## add DEG analyses data
left_join(all.DEGs %>%
select(gene_name,
abs_log2FC = logFC,
inf_v_control, BH_pval = adj.P.Val),
by=c("gene_name")) %>%
mutate(abs_log2FC = abs(abs_log2FC)) %>%
select(ophio_gene=gene_name, everything()) %>%
## add rhythmicity data - ophio_cflo - controls
left_join(rhy.24.sig[[2]] %>%
select(ophio_gene=ID, control_pval=GammaP) %>%
mutate(control_rhy24 = ifelse(control_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## add rhythmicity data - ophio_cflo - infected
left_join(rhy.24.sig[[3]] %>%
select(ophio_gene=ID, inf_pval=GammaP) %>%
mutate(inf_rhy24 = ifelse(inf_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## arrange the columns
select(ophio_gene, gene_desc, inf_v_control, abs_log2FC,
enriched_annot,
control_rhy24, inf_rhy24, GOs:TMHMM, everything()) %>%
## arrange by enriched_annot
arrange(inf_v_control, desc(abs_log2FC), enriched_annot)
}
i
gsoi.6[[i]]
gsoi.6[[1]]
I
i
SUPP FILE
SUPP FILE
gsoi.6[[i]]
i=1
gsoi.6[[i]]
### Gene set of interest 6 ###
gsoi.6 <- list()
gsoi.6[[i]] <-
which.degs[[i]] %>%
check_enrichment(.,
org = "ophio_cflo",
bg = bg.genes,
what = "pfams",
expand = T) %>%
# nothing much to talk about things that have no annotations ---
filter(annot_desc!="no_desc") %>%
# save the results to a file
arrange(annot_desc)
# MAKE THE SUPP FILE
# gsoi.6[[i]] <-
annots[[2]] %>%
select(gene_name, gene_desc, GOs, pfams, signalP, SSP, TMHMM) %>%
filter(gene_name %in% which.degs[[i]]) %>%  # change here
left_join(gsoi.6[[i]][,c(1,3)], by="gene_name") %>%  # change here
select(gene_name, gene_desc, enriched_annot=annot_desc, everything()) %>%
# mutate(enriched_annot=as.factor(enriched_annot)) %>%
arrange(enriched_annot) %>%
## add DEG analyses data
left_join(all.DEGs %>%
select(gene_name,
abs_log2FC = logFC,
inf_v_control, BH_pval = adj.P.Val),
by=c("gene_name")) %>%
mutate(abs_log2FC = abs(abs_log2FC)) %>%
select(ophio_gene=gene_name, everything()) %>%
## add rhythmicity data - ophio_cflo - controls
left_join(rhy.24.sig[[2]] %>%
select(ophio_gene=ID, control_pval=GammaP) %>%
mutate(control_rhy24 = ifelse(control_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## add rhythmicity data - ophio_cflo - infected
left_join(rhy.24.sig[[3]] %>%
select(ophio_gene=ID, inf_pval=GammaP) %>%
mutate(inf_rhy24 = ifelse(inf_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## arrange the columns
select(ophio_gene, gene_desc, inf_v_control, abs_log2FC,
enriched_annot,
control_rhy24, inf_rhy24, GOs:TMHMM, everything()) %>%
## arrange by enriched_annot
arrange(inf_v_control, desc(abs_log2FC), enriched_annot)
# define the background for enrichment analyses
bg.genes <- rownames(emat)
### Gene set of interest 6 ###
gsoi.6 <- list()
## loop begins
for (i in length(which.degs)) {
gsoi.6[[i]] <-
which.degs[[i]] %>%
check_enrichment(.,
org = "ophio_cflo",
bg = bg.genes,
what = "pfams",
expand = T) %>%
# nothing much to talk about things that have no annotations ---
filter(annot_desc!="no_desc") %>%
# save the results to a file
arrange(annot_desc)
# MAKE THE SUPP FILE
gsoi.6[[i]] <-
annots[[2]] %>%
select(gene_name, gene_desc, GOs, pfams, signalP, SSP, TMHMM) %>%
filter(gene_name %in% which.degs[[i]]) %>%  # change here
left_join(gsoi.6[[i]][,c(1,3)], by="gene_name") %>%  # change here
select(gene_name, gene_desc, enriched_annot=annot_desc, everything()) %>%
# mutate(enriched_annot=as.factor(enriched_annot)) %>%
arrange(enriched_annot) %>%
## add DEG analyses data
left_join(all.DEGs %>%
select(gene_name,
abs_log2FC = logFC,
inf_v_control, BH_pval = adj.P.Val),
by=c("gene_name")) %>%
mutate(abs_log2FC = abs(abs_log2FC)) %>%
select(ophio_gene=gene_name, everything()) %>%
## add rhythmicity data - ophio_cflo - controls
left_join(rhy.24.sig[[2]] %>%
select(ophio_gene=ID, control_pval=GammaP) %>%
mutate(control_rhy24 = ifelse(control_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## add rhythmicity data - ophio_cflo - infected
left_join(rhy.24.sig[[3]] %>%
select(ophio_gene=ID, inf_pval=GammaP) %>%
mutate(inf_rhy24 = ifelse(inf_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## arrange the columns
select(ophio_gene, gene_desc, inf_v_control, abs_log2FC,
enriched_annot,
control_rhy24, inf_rhy24, GOs:TMHMM, everything()) %>%
## arrange by enriched_annot
arrange(inf_v_control, desc(abs_log2FC), enriched_annot)
}
gsoi.6[[i]]
gsoi.6[[1]]
foo <-
which.degs[[i]] %>%
check_enrichment(.,
org = "ophio_cflo",
bg = bg.genes,
what = "pfams",
expand = T) %>%
# nothing much to talk about things that have no annotations ---
filter(annot_desc!="no_desc") %>%
# save the results to a file
arrange(annot_desc)
i
i=1
foo <-
which.degs[[i]] %>%
check_enrichment(.,
org = "ophio_cflo",
bg = bg.genes,
what = "pfams",
expand = T) %>%
# nothing much to talk about things that have no annotations ---
filter(annot_desc!="no_desc") %>%
# save the results to a file
arrange(annot_desc)
foo
foo[,c(1,3)]
i
# MAKE THE SUPP FILE
gsoi.6[[i]] <-
annots[[2]] %>%
select(gene_name, gene_desc, GOs, pfams, signalP, SSP, TMHMM) %>%
filter(gene_name %in% which.degs[[i]]) %>%  # change here
left_join(foo[,c(1,3)], by="gene_name") %>%  # change here
select(gene_name, gene_desc, enriched_annot=annot_desc, everything()) %>%
# mutate(enriched_annot=as.factor(enriched_annot)) %>%
arrange(enriched_annot) %>%
## add DEG analyses data
left_join(all.DEGs %>%
select(gene_name,
abs_log2FC = logFC,
inf_v_control, BH_pval = adj.P.Val),
by=c("gene_name")) %>%
mutate(abs_log2FC = abs(abs_log2FC)) %>%
select(ophio_gene=gene_name, everything()) %>%
## add rhythmicity data - ophio_cflo - controls
left_join(rhy.24.sig[[2]] %>%
select(ophio_gene=ID, control_pval=GammaP) %>%
mutate(control_rhy24 = ifelse(control_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## add rhythmicity data - ophio_cflo - infected
left_join(rhy.24.sig[[3]] %>%
select(ophio_gene=ID, inf_pval=GammaP) %>%
mutate(inf_rhy24 = ifelse(inf_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## arrange the columns
select(ophio_gene, gene_desc, inf_v_control, abs_log2FC,
enriched_annot,
control_rhy24, inf_rhy24, GOs:TMHMM, everything()) %>%
## arrange by enriched_annot
arrange(inf_v_control, desc(abs_log2FC), enriched_annot)
gsoi.6[[1]]
### Gene set of interest 6 ###
gsoi.6 <- list()
## loop begins
for (i in length(which.degs)) {
foo <-
which.degs[[i]] %>%
check_enrichment(.,
org = "ophio_cflo",
bg = bg.genes,
what = "pfams",
expand = T) %>%
# nothing much to talk about things that have no annotations ---
filter(annot_desc!="no_desc") %>%
# save the results to a file
arrange(annot_desc)
# MAKE THE SUPP FILE
gsoi.6[[i]] <-
annots[[2]] %>%
select(gene_name, gene_desc, GOs, pfams, signalP, SSP, TMHMM) %>%
filter(gene_name %in% which.degs[[i]]) %>%  # change here
left_join(foo[,c(1,3)], by="gene_name") %>%  # change here
select(gene_name, gene_desc, enriched_annot=annot_desc, everything()) %>%
# mutate(enriched_annot=as.factor(enriched_annot)) %>%
arrange(enriched_annot) %>%
## add DEG analyses data
left_join(all.DEGs %>%
select(gene_name,
abs_log2FC = logFC,
inf_v_control, BH_pval = adj.P.Val),
by=c("gene_name")) %>%
mutate(abs_log2FC = abs(abs_log2FC)) %>%
select(ophio_gene=gene_name, everything()) %>%
## add rhythmicity data - ophio_cflo - controls
left_join(rhy.24.sig[[2]] %>%
select(ophio_gene=ID, control_pval=GammaP) %>%
mutate(control_rhy24 = ifelse(control_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## add rhythmicity data - ophio_cflo - infected
left_join(rhy.24.sig[[3]] %>%
select(ophio_gene=ID, inf_pval=GammaP) %>%
mutate(inf_rhy24 = ifelse(inf_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## arrange the columns
select(ophio_gene, gene_desc, inf_v_control, abs_log2FC,
enriched_annot,
control_rhy24, inf_rhy24, GOs:TMHMM, everything()) %>%
## arrange by enriched_annot
arrange(inf_v_control, desc(abs_log2FC), enriched_annot)
}
i
gsoi.6[[1]]
gsoi.6[[2]]
which.de
which.degs %>% names
### Gene set of interest 6 ###
gsoi.6.up <- list()
gsoi.6.down <- list()
gsoi.6 <- list()
i
### Gene set of interest 6 ###
# gsoi.6.up <- list()
# gsoi.6.down <- list()
gsoi.6 <- list()
## loop begins
for (i in length(which.degs)) {
foo <-
which.degs[[i]] %>%
check_enrichment(.,
org = "ophio_cflo",
bg = bg.genes,
what = "pfams",
expand = T) %>%
# nothing much to talk about things that have no annotations ---
filter(annot_desc!="no_desc") %>%
# save the results to a file
arrange(annot_desc)
# MAKE THE SUPP FILE
if(i==1) {
bar.up <-
annots[[2]] %>%
select(gene_name, gene_desc, GOs, pfams, signalP, SSP, TMHMM) %>%
filter(gene_name %in% which.degs[[i]]) %>%  # change here
left_join(foo[,c(1,3)], by="gene_name") %>%  # change here
select(gene_name, gene_desc, enriched_annot=annot_desc, everything()) %>%
# mutate(enriched_annot=as.factor(enriched_annot)) %>%
arrange(enriched_annot) %>%
## add DEG analyses data
left_join(all.DEGs %>%
select(gene_name,
abs_log2FC = logFC,
inf_v_control, BH_pval = adj.P.Val),
by=c("gene_name")) %>%
mutate(abs_log2FC = abs(abs_log2FC)) %>%
select(ophio_gene=gene_name, everything()) %>%
## add rhythmicity data - ophio_cflo - controls
left_join(rhy.24.sig[[2]] %>%
select(ophio_gene=ID, control_pval=GammaP) %>%
mutate(control_rhy24 = ifelse(control_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## add rhythmicity data - ophio_cflo - infected
left_join(rhy.24.sig[[3]] %>%
select(ophio_gene=ID, inf_pval=GammaP) %>%
mutate(inf_rhy24 = ifelse(inf_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## arrange the columns
select(ophio_gene, gene_desc, inf_v_control, abs_log2FC,
enriched_annot,
control_rhy24, inf_rhy24, GOs:TMHMM, everything()) %>%
## arrange by enriched_annot
arrange(inf_v_control, desc(abs_log2FC), enriched_annot)
} else {
bar.down <-
gsoi.6[[i]] <-
annots[[2]] %>%
select(gene_name, gene_desc, GOs, pfams, signalP, SSP, TMHMM) %>%
filter(gene_name %in% which.degs[[i]]) %>%  # change here
left_join(foo[,c(1,3)], by="gene_name") %>%  # change here
select(gene_name, gene_desc, enriched_annot=annot_desc, everything()) %>%
# mutate(enriched_annot=as.factor(enriched_annot)) %>%
arrange(enriched_annot) %>%
## add DEG analyses data
left_join(all.DEGs %>%
select(gene_name,
abs_log2FC = logFC,
inf_v_control, BH_pval = adj.P.Val),
by=c("gene_name")) %>%
mutate(abs_log2FC = abs(abs_log2FC)) %>%
select(ophio_gene=gene_name, everything()) %>%
## add rhythmicity data - ophio_cflo - controls
left_join(rhy.24.sig[[2]] %>%
select(ophio_gene=ID, control_pval=GammaP) %>%
mutate(control_rhy24 = ifelse(control_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## add rhythmicity data - ophio_cflo - infected
left_join(rhy.24.sig[[3]] %>%
select(ophio_gene=ID, inf_pval=GammaP) %>%
mutate(inf_rhy24 = ifelse(inf_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## arrange the columns
select(ophio_gene, gene_desc, inf_v_control, abs_log2FC,
enriched_annot,
control_rhy24, inf_rhy24, GOs:TMHMM, everything()) %>%
## arrange by enriched_annot
arrange(inf_v_control, desc(abs_log2FC), enriched_annot)
}
}
i
bar.up
bar.donw
bar.down
bar.up
i
i=1
which.degs[[i]] %>%
check_enrichment(.,
org = "ophio_cflo",
bg = bg.genes,
what = "pfams",
expand = T) %>%
# nothing much to talk about things that have no annotations ---
filter(annot_desc!="no_desc") %>%
# save the results to a file
arrange(annot_desc)
foo <-
which.degs[[i]] %>%
check_enrichment(.,
org = "ophio_cflo",
bg = bg.genes,
what = "pfams",
expand = T) %>%
# nothing much to talk about things that have no annotations ---
filter(annot_desc!="no_desc") %>%
# save the results to a file
arrange(annot_desc)
i
### Gene set of interest 6 ###
gsoi.6 <- list()
## loop begins
for (i in 1:length(which.degs)) {
gsoi.6[[i]] <-
which.degs[[i]] %>%
check_enrichment(.,
org = "ophio_cflo",
bg = bg.genes,
what = "pfams",
expand = T) %>%
# nothing much to talk about things that have no annotations ---
filter(annot_desc!="no_desc") %>%
# save the results to a file
arrange(annot_desc)
# MAKE THE SUPP FILE
gsoi.6[[i]] <-
annots[[2]] %>%
select(gene_name, gene_desc, GOs, pfams, signalP, SSP, TMHMM) %>%
filter(gene_name %in% which.degs[[i]]) %>%  # change here
left_join(gsoi.6[[i]][,c(1,3)], by="gene_name") %>%  # change here
select(gene_name, gene_desc, enriched_annot=annot_desc, everything()) %>%
# mutate(enriched_annot=as.factor(enriched_annot)) %>%
arrange(enriched_annot) %>%
## add DEG analyses data
left_join(all.DEGs %>%
select(gene_name,
abs_log2FC = logFC,
inf_v_control, BH_pval = adj.P.Val),
by=c("gene_name")) %>%
mutate(abs_log2FC = abs(abs_log2FC)) %>%
select(ophio_gene=gene_name, everything()) %>%
## add rhythmicity data - ophio_cflo - controls
left_join(rhy.24.sig[[2]] %>%
select(ophio_gene=ID, control_pval=GammaP) %>%
mutate(control_rhy24 = ifelse(control_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## add rhythmicity data - ophio_cflo - infected
left_join(rhy.24.sig[[3]] %>%
select(ophio_gene=ID, inf_pval=GammaP) %>%
mutate(inf_rhy24 = ifelse(inf_pval < FDR/100, "yes", "no")),
by=c("ophio_gene")) %>%
## arrange the columns
select(ophio_gene, gene_desc, inf_v_control, abs_log2FC,
enriched_annot,
control_rhy24, inf_rhy24, GOs:TMHMM, everything()) %>%
## arrange by enriched_annot
arrange(inf_v_control, desc(abs_log2FC), enriched_annot)
}
gsoi.6
## Save results of not_expressed genes into an excel file
supp <- list(
"UP_DEG_ophio_control_v_inf" = gsoi.6[[1]],
"DOWN_DEG_ophio_control_v_inf" = gsoi.6[[2]])
supp
writexl::write_xlsx(supp,
path = paste0(path_to_repo,
"/results/00_supplementary_files/06_gsoi_DEG_ophio_control_v_inf.xlsx"))
# update counter
counter <- counter+1
counter
