ejtk.db <- dbConnect(RSQLite::SQLite(), paste0(path_to_repo,"/data/databases/TC6_fungal_ejtk.db"))
# DEFINE GENES OF INTEREST
rhy.24 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_24h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
rhy.12 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_12h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
rhy.08 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_08h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
# DEFINE GENES OF INTEREST
sample.name <- 'ophio_cflo'
rhy.24 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_24h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
rhy.12 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_12h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
rhy.08 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_08h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
all.modules %>% head()
all.modules %>%
select(module_identity, gene_ID_robin)
# Get all the module colos
module_colors <-
all.modules %>%
select(module_identity) %>%
unique()
# Get all the module colos
module_colors <-
all.modules %>%
select(module_identity) %>%
unique()
View(module_colors)
# Get all the module colos
module_colors <-
all.modules %>%
select(module_identity) %>%
unique() %>%
list()
View(module_colors)
View(module_colors)
# Get all the module colos
module_colors <-
all.modules %>%
select(module_identity) %>%
pull(module_identity) %>%
unique() %>%
list()
View(module_colors)
# Get all the module colos
module_colors <-
all.modules %>%
pull(module_identity) %>%
unique() %>%
list()
View(module_colors)
# Get all the module colos
module_colors <-
all.modules %>%
pull(module_identity) %>%
unique()
View(module_genes)
# Get all the module colos
module_colors <-
all.modules %>%
pull(module_identity) %>%
unique()
for i in module_colors {
print(length(i), i)
}
## Give lenght of all modules
for i in module_colors {
print(length(i), i)
}
## Give lenght of all modules
for i in module_colors {
print(length(i), i)
}
## Give lenght of all modules
for (i in module_colors) {
print(length(i), i)
}
print(i)
print(module_colors[i])
print(i)
for (i in module_colors) {
print(i)
}
for (i in module_colors) {
i
%>% print()
%>% length()
}
## Give lenght of all modules
for (i in module_colors) {
i
%>% print()
%>% length()
}
for (i in module_colors) {
i  %>%
print()%>%
length()
}
length(i)
for (i in module_colors) {
print(i)
length(i)
}
print(length(i))
for (i in module_colors) {
print(i)
print(length(i))
}
i <- 'brown'
all.modules %>%
filter(module_identity==i)
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
glue('module_{i}') <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
length(module)
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
print(i)
length(module)
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
print(i)
length(module)
}
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
print(i)
print(length(module))
}
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
# print(i)
print(length(module))
}
## Give lenght of all modules
list_x <- ''
# print(i)
list_x <- append(list_x, c(print(i),lenght(module)))
# print(i)
list_x <- append(list_x, c(print(i), length(module)))
## Give lenght of all modules
list_x <- ''
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
# print(i)
list_x <- append(list_x, c(print(i), length(module)))
}
## Give lenght of all modules
list_x <-
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
# print(i)
list_x <- append(list_x, c(print(i), length(module)))
}
## Give lenght of all modules
list_x <-
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
# print(i)
list_x <- append(list_x, c(print(i), length(module)))
}
## Give lenght of all modules
list_x <-
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
# print(i)
list_x <- append(list_x, c(print(i), length(module)))
}
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
# print(i)
list_x <- append(list_x, c(print(i), length(module)))
}
print(list_x)
list_x <-
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
collr <- print(i)
list_x <- append(list_x, past0(collr,'(', length(module), ')'))
}
list_x <-
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
collr <- print(i)
list_x <- append(list_x, paste0(collr,'(', length(module), ')'))
}
list_x <- append(list_x, list_name)
## Give lenght of all modules
list_x <-
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
len_module <- length(module)
list_name <- glue('{i}\n({len_module})')
list_x <- append(list_x, list_name)
}
## Give lenght of all modules
list_x <-
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
len_module <- length(module)
list_name <- glue('{i}\n({len_module})')
list_x <- append(list_x, list_name)
}
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
len_module <- length(module)
list_name <- glue('{i}\n({len_module})')
list_x <- append(list_x, list_name)
}
list_x <-
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
len_module <- length(module)
list_name <- glue('{i}({len_module})')
list_x <- append(list_x, list_name)
}
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
len_module <- length(module)
list_name <- glue('{i}({len_module})')
list_x <- append(list_x, list_name)
}
## Give lenght of all modules
list_x <- NULL
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
len_module <- length(module)
list_name <- glue('{i} ({len_module})')
list_x <- append(list_x, list_name)
}
print(list_x)
# write to txt
lapply(list_x, write, "./lenght_module_list.txt", append=TRUE, ncolumns=1000)
species <- 'beau'
### Data of genes with their modules
all.modules <- read_csv(glue('./results/networks/{species}_gene_IDs_and_module_identity.csv'))
# Get all the module colors in list
module_colors <-
all.modules %>%
pull(module_identity) %>%
unique()
## Give lenght of all modules
list_x <- NULL
for (i in module_colors) {
module <-
all.modules %>%
filter(module_identity==i) %>%
pull(gene_ID_ncbi)
len_module <- length(module)
list_name <- glue('{i} ({len_module})')
list_x <- append(list_x, list_name)
}
# write to txt
lapply(list_x, write, glue(".results/networks/{species}_length_module_list.txt"), append=TRUE, ncolumns=1000)
# write to txt
lapply(list_x, write, glue("./results/networks/{species}_length_module_list.txt"), append=TRUE, ncolumns=1000)
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
module_name <- 'brown'
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
module_name <- 'darkred'
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
# DEFINE GENES OF INTEREST
sample.name <- 'beau'
rhy.24 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_24h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
rhy.12 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_12h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
rhy.08 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_08h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
intersect(module, rhy.24)
intersect(module, rhy.24) %>% length()
module_name <- 'red'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.24) %>% length()
module_name <- 'salmon'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.24) %>% length()
module_name <- 'darkturquoise'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.12) %>% length()
module_name <- 'darkgrey'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.12) %>% length()
module_name <- 'mignightblue'
module_name <- 'midnightblue'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.12) %>% length()
module_name <- 'orange'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.12) %>% length()
intersect(module, rhy.08) %>% length()
module_name <- 'darkgrey'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.08) %>% length()
# DEFINE GENES OF INTEREST
sample.name <- 'ophio_cflo'
rhy.24 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_24h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
rhy.12 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_12h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
rhy.08 <-
tbl(ejtk.db, paste0(sample.name,"_zscores_08h")) %>%
filter(GammaP < 0.05) %>% pull(ID)
species <- 'ophio_cflo'
### Data of genes with their modules
all.modules <- read_csv(glue('./results/networks/{species}_gene_IDs_and_module_identity.csv'))
# Get all the module colors in list
module_colors <-
all.modules %>%
pull(module_identity) %>%
unique()
module_name <- 'brown'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.24) %>% length()
module_name <- 'midnightblue'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.24) %>% length()
module_name <- 'tan'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.24) %>% length()
module_name <- 'darkturquoise'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.24) %>% length()
module_name <- 'darkred'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.12) %>% length()
module_name <- 'black'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.12) %>% length()
module_name <- 'salmon'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.12) %>% length()
module_name <- 'steelblue'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.12) %>% length()
module_name <- 'greenyellow'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.12) %>% length()
module_name <- 'royalblue'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.12) %>% length()
module_name <- 'orange'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.08) %>% length()
module_name <- 'turqouise'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.08) %>% length()
module_name <- 'turquoise'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.08) %>% length()
module_name <- 'darkgreen'
module_name <- 'darkgreen'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.08) %>% length()
module_name <- 'darkgrey'
module <-
all.modules %>%
filter(module_identity==module_name) %>%
pull(gene_ID_ncbi)
intersect(module, rhy.08) %>% length()
length(rhy.08)
length(rhy.12)
length(rhy.24)
