pacman::p_load(RSQLite, tidyverse, dbplyr, DT, conflicted)
#
# set conflict preference (housekeeping to make sure functions work as expected)
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("layout", "plotly")
#
## load functions ---------
source("./functions/enrichment_analysis.R")
#
## set parameters and thresholds --------
#
# gamma-pvalue threshold for inferring rhythmicity
gamma.pval = 0.05
# 00. Load Databases -----------------------------------------------------------
#
# 1. TC7_ejtk.db
# Desc: This database contains all ejtk-output for TC7
ejtk.db <- dbConnect(RSQLite::SQLite(),
"./data/databases/TC6_fungal_ejtk.db")
# which tables are in the database
src_dbi(ejtk.db)
# Housekeeping ---------------------------------------------------------------
#
set.seed(420)
rm(list = ls())
#
## Load packages ----------
pacman::p_load(pheatmap, dendextend, tidyverse, viridis)
pacman::p_load(RSQLite, tidyverse, dbplyr, DT, conflicted)
#
# set conflict preference (housekeeping to make sure functions work as expected)
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("layout", "plotly")
#
## set parameters and thresholds --------
#
# gamma-pvalue threshold for inferring rhythmicity
gamma.pval = 0.05
# Desc: This database will contain all ejtk-output for fungal expression data collected for TC6
#
### Contents (last updated 02-Sep-21)
# a. ophio_cflo_zscores_24h
# b. ophio_cflo_zscores_12h
# c. ophio_cflo_zscores_08h
# d. ophio_kim_LD_zscores_24h
# e. ophio_kim_DD_zscores_24h
#
# Load the data
my.db <- dbConnect(RSQLite::SQLite(),
"./data/databases/TC6_fungal_ejtk.db")
# which tables are in the database
src_dbi(my.db)
# ## load("/path/to/file.RData)
# ## End.
# #
# #
## z-score >> eJTK ------------------------
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period = 24h
ophio.cflo.24.zscore <- read.csv("./results/ejtk_output/ophio_cflo/from_zscore/ophio_cflo_zscores_noNAs_cos24_ph0020by4_as0420by4_zscore_jtkout_GammaP.txt",
sep = "\t", header = T, stringsAsFactors = F)
# ## load("/path/to/file.RData)
# ## End.
# #
# #
## z-score >> eJTK ------------------------
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period = 24h
ophio.cflo.24.zscore <- read.csv("./results/ejtk_output/ophio_cflo/zscore/ophio_cflo_zscores_noNAs_cos24_ph0020by4_as0420by4_zscore_jtkout_GammaP.txt",
sep = "\t", header = T, stringsAsFactors = F)
# ## load("/path/to/file.RData)
# ## End.
# #
# #
## z-score >> eJTK ------------------------
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period = 24h
ophio.cflo.24.zscore <- read.csv("./results/ejtk_output/ophio_cflo/zscore/ophio_cflo_zscores_noNAs_cos24_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt",
sep = "\t", header = T, stringsAsFactors = F)
ophio.cflo.24.zscore %>%
head()
# Save file to database
dbWriteTable(my.db, "ophio_cflo_zscores_24h", ophio.cflo.24.zscore)
dbRemoveTable(my.db, "ophio_cflo_zscores_24h")
# which tables are in the database
src_dbi(my.db)
dbRemoveTable(my.db, "ophio_cflo_zscores_08h")
dbRemoveTable(my.db, "ophio_cflo_zscores_12h")
# which tables are in the database
src_dbi(my.db)
# ## load("/path/to/file.RData)
# ## End.
# #
# #
## z-score >> eJTK ------------------------
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period = 24h
ophio.cflo.24.zscore <- read.csv("./results/ejtk_output/ophio_cflo/zscore/ophio_cflo_zscores_noNAs_cos24_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt",
sep = "\t", header = T, stringsAsFactors = F)
#
# Choose species
species <- 'ophio_cflo'
dbRemoveTable(my.db, "ophio_cflo_zscores_24h")
src_dbi(my.db)
print(species)
test <- f({species}.24.zscore)
test <- f('{species}.24.zscore')
test <- f('{species}.24.zscore')
libraby(glue)
library(glue)
species <- 'ophio.cflo'
glue('{species}.24.zscore')
# ## load("/path/to/file.RData)
# ## End.
# #
# #
## z-score >> eJTK ------------------------
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period = 24h
glue('{species}.24.zscore') <- read.csv("./results/ejtk_output/ophio_cflo/zscore/ophio_cflo_zscores_noNAs_cos24_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt",
sep = "\t", header = T, stringsAsFactors = F)
glue('{species}.24.zscore')
# ## load("/path/to/file.RData)
# ## End.
# #
# #
## z-score >> eJTK ------------------------
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period = 24h
glue('{species}.24.zscore') %>% name.24.zscore <- read.csv("./results/ejtk_output/ophio_cflo/zscore/ophio_cflo_zscores_noNAs_cos24_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt",
sep = "\t", header = T, stringsAsFactors = F)
glue({species}.24.zscore)
test <- glue('{species}.24.zscore')
print(test)
# Save file to database
name <- glue('{species}.24.zscore')
dbWriteTable(my.db, name, zscore.24h)
# ## load("/path/to/file.RData)
# ## End.
# #
# #
## z-score >> eJTK ------------------------
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period = 24h
szcore.24h <- read.csv("./results/ejtk_output/ophio_cflo/zscore/ophio_cflo_zscores_noNAs_cos24_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt",
sep = "\t", header = T, stringsAsFactors = F)
zscore.24h %>%
head()
# ## load("/path/to/file.RData)
# ## End.
# #
# #
## z-score >> eJTK ------------------------
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period = 24h
zscore.24h <- read.csv("./results/ejtk_output/ophio_cflo/zscore/ophio_cflo_zscores_noNAs_cos24_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt",
sep = "\t", header = T, stringsAsFactors = F)
zscore.24h %>%
head()
# Save file to database
name <- glue('{species}.24.zscore')
dbWriteTable(my.db, name, zscore.24h)
src_dbi(my.db)
# CSV name
csv.name <- glue("./results/ejtk_output/ophio_cflo/zscore/ophio_cflo_zscores_noNAs_cos{period}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
period <- '24'
# CSV name
csv.name <- glue("./results/ejtk_output/ophio_cflo/zscore/ophio_cflo_zscores_noNAs_cos{period}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
print(csv.name)
# CSV name
csv.name <- glue("./results/ejtk_output/{species}/zscore/{species}_zscores_noNAs_cos{period}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
print(csv.name)
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period = 24h
zscore.24h <- read.csv(csv.name,
sep = "\t", header = T, stringsAsFactors = F)
#
# Choose species
species <- 'ophio_cflo'
# CSV name
csv.name <- glue("./results/ejtk_output/{species}/zscore/{species}_zscores_noNAs_cos{period}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period = 24h
zscore.24h <- read.csv(csv.name,
sep = "\t", header = T, stringsAsFactors = F)
zscore.24h %>%
head()
src_dbi(my.db)
dbRemoveTable(my.db, "ophio.cflo.24.zscore")
# Housekeeping ---------------------------------------------------------------
#
set.seed(420)
rm(list = ls())
#
## Load packages ----------
pacman::p_load(pheatmap, dendextend, tidyverse, viridis)
pacman::p_load(RSQLite, tidyverse, dbplyr, DT, conflicted)
#
# set conflict preference (housekeeping to make sure functions work as expected)
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("layout", "plotly")
#
## set parameters and thresholds --------
#
# gamma-pvalue threshold for inferring rhythmicity
gamma.pval = 0.05
# Desc: This database will contain all ejtk-output for fungal expression data collected for TC6
#
### Contents (last updated 02-Sep-21)
# a. ophio_cflo_zscores_24h
# b. ophio_cflo_zscores_12h
# c. ophio_cflo_zscores_08h
# d. ophio_kim_LD_zscores_24h
# e. ophio_kim_DD_zscores_24h
#
# Load the data
my.db <- dbConnect(RSQLite::SQLite(),
"./data/databases/TC6_fungal_ejtk.db")
# which tables are in the database
src_dbi(my.db)
#
# Load library glue for naming purposes
library(glue)
#
# Choose species
species <- 'ophio_cflo'
#      file = "./data/rdata/rhythmic_genes/ophio_cflo_rhy_genes_gammap_05.RData")
# #
# ## To read the RData file, use:
# ## load("/path/to/file.RData)
# ## End.
# #
# #
## z-score >> eJTK ------------------------
#
# Give the period and name the file
period <- '24'
name <- glue('{species}_zscore_{period}h')
# CSV name
csv.name <- glue("./results/ejtk_output/{species}/zscore/{species}_zscores_noNAs_cos{period}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period = 24h
zscore <- read.csv(csv.name,
sep = "\t", header = T, stringsAsFactors = F)
zscore %>%
head()
# Save file to database
dbWriteTable(my.db, name, zscore)
src_dbi(my.db)
# Housekeeping ---------------------------------------------------------------
#
set.seed(420)
rm(list = ls())
#
## Load packages ----------
pacman::p_load(pheatmap, dendextend, tidyverse, viridis)
pacman::p_load(RSQLite, tidyverse, dbplyr, DT, conflicted)
#
# set conflict preference (housekeeping to make sure functions work as expected)
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("layout", "plotly")
#
## set parameters and thresholds --------
#
# gamma-pvalue threshold for inferring rhythmicity
gamma.pval = 0.05
# Desc: This database will contain all ejtk-output for fungal expression data collected for TC6
#
### Contents (last updated 20-Sep-21)
# a. ophio_cflo_zscores_24h
# b. ophio_cflo_zscores_12h
# c. ophio_cflo_zscores_08h
# d. ophio_kim_LD_zscores_24h
# e. ophio_kim_DD_zscores_24h
#
# Load the data
my.db <- dbConnect(RSQLite::SQLite(),
"./data/databases/TC6_fungal_ejtk.db")
# which tables are in the database
src_dbi(my.db)
#
# Load library glue for naming purposes
library(glue)
#
# Choose species
species <- 'ophio_cflo'
## z-score >> eJTK ------------------------
#
# Give the period and use that to name the file
period <- '12'
name <- glue('{species}_zscore_{period}h')
# CSV name
csv.name <- glue("./results/ejtk_output/{species}/zscore/{species}_zscores_noNAs_cos{period}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period
zscore <- read.csv(csv.name,
sep = "\t", header = T, stringsAsFactors = F)
zscore %>%
head()
# Save file to database
dbWriteTable(my.db, name, zscore)
# which tables are in the database
src_dbi(my.db)
## z-score >> eJTK ------------------------
#
# Give the period and use that to name the file
period <- '08'
name <- glue('{species}_zscore_{period}h')
# CSV name
csv.name <- glue("./results/ejtk_output/{species}/zscore/{species}_zscores_noNAs_cos{period}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period
zscore <- read.csv(csv.name,
sep = "\t", header = T, stringsAsFactors = F)
zscore %>%
head()
# Save file to database
dbWriteTable(my.db, name, zscore)
src_dbi(my.db)
#
# Choose species
species <- 'beau'
## z-score >> eJTK ------------------------
#
# Give the period and use that to name the file
period <- '08'
name <- glue('{species}_zscore_{period}h')
# CSV name
csv.name <- glue("./results/ejtk_output/{species}/zscore/{species}_zscores_noNAs_cos{period}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period
zscore <- read.csv(csv.name,
sep = "\t", header = T, stringsAsFactors = F)
zscore %>%
head()
# Save file to database
dbWriteTable(my.db, name, zscore)
## z-score >> eJTK ------------------------
#
# Give the period and use that to name the file
period <- '12'
name <- glue('{species}_zscore_{period}h')
# CSV name
csv.name <- glue("./results/ejtk_output/{species}/zscore/{species}_zscores_noNAs_cos{period}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period
zscore <- read.csv(csv.name,
sep = "\t", header = T, stringsAsFactors = F)
zscore %>%
head()
# Save file to database
dbWriteTable(my.db, name, zscore)
## z-score >> eJTK ------------------------
#
# Give the period and use that to name the file
period <- '24'
name <- glue('{species}_zscore_{period}h')
# CSV name
csv.name <- glue("./results/ejtk_output/{species}/zscore/{species}_zscores_noNAs_cos{period}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period
zscore <- read.csv(csv.name,
sep = "\t", header = T, stringsAsFactors = F)
zscore %>%
head()
# Save file to database
dbWriteTable(my.db, name, zscore)
src_dbi(my.db)
periods <- c(08,12,24)
print(periods)
for i in periods:
for (i in periods){print(i)}
periods <- c(08,12,24) %>%
as.character
dbRemoveTable(my.db, "beau_zscore_08h")
dbRemoveTable(my.db, "beau_zscore_12h")
dbRemoveTable(my.db, "beau_zscore_24h")
# Housekeeping ---------------------------------------------------------------
#
set.seed(420)
rm(list = ls())
#
## Load packages ----------
pacman::p_load(pheatmap, dendextend, tidyverse, viridis)
pacman::p_load(RSQLite, tidyverse, dbplyr, DT, conflicted)
#
# set conflict preference (housekeeping to make sure functions work as expected)
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("layout", "plotly")
#
## set parameters and thresholds --------
#
# gamma-pvalue threshold for inferring rhythmicity
gamma.pval = 0.05
# Desc: This database will contain all ejtk-output for fungal expression data collected for TC6
#
### Contents (last updated 20-Sep-21)
# a. ophio_cflo_zscores_24h
# b. ophio_cflo_zscores_12h
# c. ophio_cflo_zscores_08h
# d. ophio_kim_LD_zscores_24h
# e. ophio_kim_DD_zscores_24h
#
# Load the data
my.db <- dbConnect(RSQLite::SQLite(),
"./data/databases/TC6_fungal_ejtk.db")
# which tables are in the database
src_dbi(my.db)
#
# Load library glue for naming purposes
library(glue)
#
# Choose species
species <- 'beau'
## z-score >> eJTK ------------------------
#
# Give the periods (8h, 12h, 24h)
periods <- c(08,12,24) %>%
as.character
for (i in periods) {
# name the file with the species and period
name <- glue('{species}_zscore_{i}h')
# CSV name
csv.name <- glue("./results/ejtk_output/{species}/zscore/{species}_zscores_noNAs_cos{i}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period
zscore <- read.csv(csv.name,
sep = "\t", header = T, stringsAsFactors = F)
zscore %>%
head()
# Save file to database
dbWriteTable(my.db, name, zscore)
}
## z-score >> eJTK ------------------------
#
# Give the periods (8h, 12h, 24h)
periods <- c('08',12,24) %>%
as.character
for (i in periods) {
# name the file with the species and period
name <- glue('{species}_zscore_{i}h')
# CSV name
csv.name <- glue("./results/ejtk_output/{species}/zscore/{species}_zscores_noNAs_cos{i}_ph0022by2_as0222by2_zscore_jtkout_GammaP.txt")
#
# Note: ophio.cflo.24.zscore is exactly the same as ophio.cflo.24 meaning that using
#       FPKM values or z-scores to run eJTK does not change the result
#
## Period
zscore <- read.csv(csv.name,
sep = "\t", header = T, stringsAsFactors = F)
zscore %>%
head()
# Save file to database
dbWriteTable(my.db, name, zscore)
}
src_dbi(my.db)
